Modified version of the original FCNT code before it was published on GitHub.

Originally written by Lijun Wang. Modified by Kai Kang (myfavouritekk@gmail.com).
